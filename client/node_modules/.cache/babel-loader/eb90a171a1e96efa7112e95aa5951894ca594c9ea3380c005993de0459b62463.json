{"ast":null,"code":"import { isTextSelection, isNodeSelection, posToDOMRect, Extension } from '@tiptap/core';\nimport { Plugin, PluginKey } from '@tiptap/pm/state';\nimport tippy from 'tippy.js';\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\n\nfunction isObject$2(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\nvar isObject_1 = isObject$2;\n\n/** Detect free variable `global` from Node.js. */\n\nvar freeGlobal$1 = typeof commonjsGlobal == 'object' && commonjsGlobal && commonjsGlobal.Object === Object && commonjsGlobal;\nvar _freeGlobal = freeGlobal$1;\nvar freeGlobal = _freeGlobal;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root$2 = freeGlobal || freeSelf || Function('return this')();\nvar _root = root$2;\nvar root$1 = _root;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now$1 = function () {\n  return root$1.Date.now();\n};\nvar now_1 = now$1;\n\n/** Used to match a single whitespace character. */\n\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex$1(string) {\n  var index = string.length;\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\nvar _trimmedEndIndex = trimmedEndIndex$1;\nvar trimmedEndIndex = _trimmedEndIndex;\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim$1(string) {\n  return string ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '') : string;\n}\nvar _baseTrim = baseTrim$1;\nvar root = _root;\n\n/** Built-in value references. */\nvar Symbol$2 = root.Symbol;\nvar _Symbol = Symbol$2;\nvar Symbol$1 = _Symbol;\n\n/** Used for built-in method references. */\nvar objectProto$1 = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto$1.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString$1 = objectProto$1.toString;\n\n/** Built-in value references. */\nvar symToStringTag$1 = Symbol$1 ? Symbol$1.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag$1(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag$1),\n    tag = value[symToStringTag$1];\n  try {\n    value[symToStringTag$1] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n  var result = nativeObjectToString$1.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag$1] = tag;\n    } else {\n      delete value[symToStringTag$1];\n    }\n  }\n  return result;\n}\nvar _getRawTag = getRawTag$1;\n\n/** Used for built-in method references. */\n\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString$1(value) {\n  return nativeObjectToString.call(value);\n}\nvar _objectToString = objectToString$1;\nvar Symbol = _Symbol,\n  getRawTag = _getRawTag,\n  objectToString = _objectToString;\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n  undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag$1(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return symToStringTag && symToStringTag in Object(value) ? getRawTag(value) : objectToString(value);\n}\nvar _baseGetTag = baseGetTag$1;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\n\nfunction isObjectLike$1(value) {\n  return value != null && typeof value == 'object';\n}\nvar isObjectLike_1 = isObjectLike$1;\nvar baseGetTag = _baseGetTag,\n  isObjectLike = isObjectLike_1;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol$1(value) {\n  return typeof value == 'symbol' || isObjectLike(value) && baseGetTag(value) == symbolTag;\n}\nvar isSymbol_1 = isSymbol$1;\nvar baseTrim = _baseTrim,\n  isObject$1 = isObject_1,\n  isSymbol = isSymbol_1;\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber$1(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject$1(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject$1(other) ? other + '' : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return isBinary || reIsOctal.test(value) ? freeParseInt(value.slice(2), isBinary ? 2 : 8) : reIsBadHex.test(value) ? NAN : +value;\n}\nvar toNumber_1 = toNumber$1;\nvar isObject = isObject_1,\n  now = now_1,\n  toNumber = toNumber_1;\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n  nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n    lastThis,\n    maxWait,\n    result,\n    timerId,\n    lastCallTime,\n    lastInvokeTime = 0,\n    leading = false,\n    maxing = false,\n    trailing = true;\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  function invokeFunc(time) {\n    var args = lastArgs,\n      thisArg = lastThis;\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n      timeSinceLastInvoke = time - lastInvokeTime,\n      timeWaiting = wait - timeSinceLastCall;\n    return maxing ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke) : timeWaiting;\n  }\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n      timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return lastCallTime === undefined || timeSinceLastCall >= wait || timeSinceLastCall < 0 || maxing && timeSinceLastInvoke >= maxWait;\n  }\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n  function debounced() {\n    var time = now(),\n      isInvoking = shouldInvoke(time);\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\nvar debounce_1 = debounce;\nclass BubbleMenuView {\n  constructor(_ref) {\n    let {\n      editor,\n      element,\n      view,\n      tippyOptions = {},\n      updateDelay = 250,\n      shouldShow\n    } = _ref;\n    this.preventHide = false;\n    this.shouldShow = _ref2 => {\n      let {\n        view,\n        state,\n        from,\n        to\n      } = _ref2;\n      const {\n        doc,\n        selection\n      } = state;\n      const {\n        empty\n      } = selection;\n      // Sometime check for `empty` is not enough.\n      // Doubleclick an empty paragraph returns a node size of 2.\n      // So we check also for an empty text size.\n      const isEmptyTextBlock = !doc.textBetween(from, to).length && isTextSelection(state.selection);\n      // When clicking on a element inside the bubble menu the editor \"blur\" event\n      // is called and the bubble menu item is focussed. In this case we should\n      // consider the menu as part of the editor and keep showing the menu\n      const isChildOfMenu = this.element.contains(document.activeElement);\n      const hasEditorFocus = view.hasFocus() || isChildOfMenu;\n      if (!hasEditorFocus || empty || isEmptyTextBlock || !this.editor.isEditable) {\n        return false;\n      }\n      return true;\n    };\n    this.mousedownHandler = () => {\n      this.preventHide = true;\n    };\n    this.dragstartHandler = () => {\n      this.hide();\n    };\n    this.focusHandler = () => {\n      // we use `setTimeout` to make sure `selection` is already updated\n      setTimeout(() => this.update(this.editor.view));\n    };\n    this.blurHandler = _ref3 => {\n      let {\n        event\n      } = _ref3;\n      var _a;\n      if (this.preventHide) {\n        this.preventHide = false;\n        return;\n      }\n      if ((event === null || event === void 0 ? void 0 : event.relatedTarget) && ((_a = this.element.parentNode) === null || _a === void 0 ? void 0 : _a.contains(event.relatedTarget))) {\n        return;\n      }\n      this.hide();\n    };\n    this.tippyBlurHandler = event => {\n      this.blurHandler({\n        event\n      });\n    };\n    this.updateHandler = (view, oldState) => {\n      var _a, _b, _c;\n      const {\n        state,\n        composing\n      } = view;\n      const {\n        doc,\n        selection\n      } = state;\n      const isSame = oldState && oldState.doc.eq(doc) && oldState.selection.eq(selection);\n      if (composing || isSame) {\n        return;\n      }\n      this.createTooltip();\n      // support for CellSelections\n      const {\n        ranges\n      } = selection;\n      const from = Math.min(...ranges.map(range => range.$from.pos));\n      const to = Math.max(...ranges.map(range => range.$to.pos));\n      const shouldShow = (_a = this.shouldShow) === null || _a === void 0 ? void 0 : _a.call(this, {\n        editor: this.editor,\n        view,\n        state,\n        oldState,\n        from,\n        to\n      });\n      if (!shouldShow) {\n        this.hide();\n        return;\n      }\n      (_b = this.tippy) === null || _b === void 0 ? void 0 : _b.setProps({\n        getReferenceClientRect: ((_c = this.tippyOptions) === null || _c === void 0 ? void 0 : _c.getReferenceClientRect) || (() => {\n          if (isNodeSelection(state.selection)) {\n            const node = view.nodeDOM(from);\n            if (node) {\n              return node.getBoundingClientRect();\n            }\n          }\n          return posToDOMRect(view, from, to);\n        })\n      });\n      this.show();\n    };\n    this.editor = editor;\n    this.element = element;\n    this.view = view;\n    this.updateDelay = updateDelay;\n    if (shouldShow) {\n      this.shouldShow = shouldShow;\n    }\n    this.element.addEventListener('mousedown', this.mousedownHandler, {\n      capture: true\n    });\n    this.view.dom.addEventListener('dragstart', this.dragstartHandler);\n    this.editor.on('focus', this.focusHandler);\n    this.editor.on('blur', this.blurHandler);\n    this.tippyOptions = tippyOptions;\n    // Detaches menu content from its current parent\n    this.element.remove();\n    this.element.style.visibility = 'visible';\n  }\n  createTooltip() {\n    const {\n      element: editorElement\n    } = this.editor.options;\n    const editorIsAttached = !!editorElement.parentElement;\n    if (this.tippy || !editorIsAttached) {\n      return;\n    }\n    this.tippy = tippy(editorElement, {\n      duration: 0,\n      getReferenceClientRect: null,\n      content: this.element,\n      interactive: true,\n      trigger: 'manual',\n      placement: 'top',\n      hideOnClick: 'toggle',\n      ...this.tippyOptions\n    });\n    // maybe we have to hide tippy on its own blur event as well\n    if (this.tippy.popper.firstChild) {\n      this.tippy.popper.firstChild.addEventListener('blur', this.tippyBlurHandler);\n    }\n  }\n  update(view, oldState) {\n    const {\n      state\n    } = view;\n    const hasValidSelection = state.selection.$from.pos !== state.selection.$to.pos;\n    if (this.updateDelay > 0 && hasValidSelection) {\n      debounce_1(this.updateHandler, this.updateDelay)(view, oldState);\n    } else {\n      this.updateHandler(view, oldState);\n    }\n  }\n  show() {\n    var _a;\n    (_a = this.tippy) === null || _a === void 0 ? void 0 : _a.show();\n  }\n  hide() {\n    var _a;\n    (_a = this.tippy) === null || _a === void 0 ? void 0 : _a.hide();\n  }\n  destroy() {\n    var _a, _b;\n    if ((_a = this.tippy) === null || _a === void 0 ? void 0 : _a.popper.firstChild) {\n      this.tippy.popper.firstChild.removeEventListener('blur', this.tippyBlurHandler);\n    }\n    (_b = this.tippy) === null || _b === void 0 ? void 0 : _b.destroy();\n    this.element.removeEventListener('mousedown', this.mousedownHandler, {\n      capture: true\n    });\n    this.view.dom.removeEventListener('dragstart', this.dragstartHandler);\n    this.editor.off('focus', this.focusHandler);\n    this.editor.off('blur', this.blurHandler);\n  }\n}\nconst BubbleMenuPlugin = options => {\n  return new Plugin({\n    key: typeof options.pluginKey === 'string' ? new PluginKey(options.pluginKey) : options.pluginKey,\n    view: view => new BubbleMenuView({\n      view,\n      ...options\n    })\n  });\n};\nconst BubbleMenu = Extension.create({\n  name: 'bubbleMenu',\n  addOptions() {\n    return {\n      element: null,\n      tippyOptions: {},\n      pluginKey: 'bubbleMenu',\n      updateDelay: undefined,\n      shouldShow: null\n    };\n  },\n  addProseMirrorPlugins() {\n    if (!this.options.element) {\n      return [];\n    }\n    return [BubbleMenuPlugin({\n      pluginKey: this.options.pluginKey,\n      editor: this.editor,\n      element: this.options.element,\n      tippyOptions: this.options.tippyOptions,\n      updateDelay: this.options.updateDelay,\n      shouldShow: this.options.shouldShow\n    })];\n  }\n});\nexport { BubbleMenu, BubbleMenuPlugin, BubbleMenuView, BubbleMenu as default };","map":{"version":3,"names":["isObject$2","isObject","value","type","isObject_1","freeGlobal$1","commonjsGlobal","Object","_freeGlobal","freeGlobal","freeSelf","self","root$2","Function","_root","root$1","now$1","now","Date","now_1","reWhitespace","trimmedEndIndex$1","trimmedEndIndex","string","index","length","test","charAt","_trimmedEndIndex","reTrimStart","baseTrim$1","baseTrim","slice","replace","_baseTrim","root","Symbol$2","Symbol","_Symbol","Symbol$1","objectProto$1","prototype","hasOwnProperty","nativeObjectToString$1","toString","symToStringTag$1","toStringTag","undefined","getRawTag$1","getRawTag","isOwn","call","tag","unmasked","e","result","_getRawTag","objectProto","nativeObjectToString","objectToString$1","objectToString","_objectToString","nullTag","undefinedTag","symToStringTag","baseGetTag$1","baseGetTag","_baseGetTag","isObjectLike$1","isObjectLike","isObjectLike_1","symbolTag","isSymbol$1","isSymbol","isSymbol_1","isObject$1","NAN","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","toNumber$1","toNumber","other","valueOf","isBinary","toNumber_1","FUNC_ERROR_TEXT","nativeMax","Math","max","nativeMin","min","debounce","func","wait","options","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","apply","leadingEdge","setTimeout","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","cancel","clearTimeout","flush","debounced","isInvoking","arguments","debounce_1","BubbleMenuView","constructor","_ref","editor","element","view","tippyOptions","updateDelay","shouldShow","preventHide","_ref2","state","from","to","doc","selection","empty","isEmptyTextBlock","textBetween","isTextSelection","isChildOfMenu","contains","document","activeElement","hasEditorFocus","hasFocus","isEditable","mousedownHandler","dragstartHandler","hide","focusHandler","update","blurHandler","_ref3","event","relatedTarget","_a","parentNode","tippyBlurHandler","updateHandler","oldState","composing","isSame","eq","createTooltip","ranges","map","range","$from","pos","$to","_b","tippy","setProps","getReferenceClientRect","_c","isNodeSelection","node","nodeDOM","getBoundingClientRect","posToDOMRect","show","addEventListener","capture","dom","on","remove","style","visibility","editorElement","editorIsAttached","parentElement","duration","content","interactive","trigger","placement","hideOnClick","popper","firstChild","hasValidSelection","destroy","removeEventListener","off","BubbleMenuPlugin","Plugin","key","pluginKey","PluginKey","BubbleMenu","Extension","create","name","addOptions","addProseMirrorPlugins"],"sources":["C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\isObject.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_freeGlobal.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_root.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\now.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_trimmedEndIndex.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_baseTrim.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_Symbol.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_getRawTag.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_objectToString.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_baseGetTag.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\isObjectLike.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\isSymbol.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\toNumber.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\debounce.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\@tiptap\\extension-bubble-menu\\src\\bubble-menu-plugin.ts","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\@tiptap\\extension-bubble-menu\\src\\bubble-menu.ts"],"sourcesContent":["/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","import {\n  Editor, isNodeSelection, isTextSelection, posToDOMRect,\n} from '@tiptap/core'\nimport { EditorState, Plugin, PluginKey } from '@tiptap/pm/state'\nimport { EditorView } from '@tiptap/pm/view'\nimport debounce from 'lodash/debounce'\nimport tippy, { Instance, Props } from 'tippy.js'\n\nexport interface BubbleMenuPluginProps {\n  pluginKey: PluginKey | string\n  editor: Editor\n  element: HTMLElement\n  tippyOptions?: Partial<Props>\n  updateDelay?: number\n  shouldShow?:\n    | ((props: {\n        editor: Editor\n        view: EditorView\n        state: EditorState\n        oldState?: EditorState\n        from: number\n        to: number\n      }) => boolean)\n    | null\n}\n\nexport type BubbleMenuViewProps = BubbleMenuPluginProps & {\n  view: EditorView\n}\n\nexport class BubbleMenuView {\n  public editor: Editor\n\n  public element: HTMLElement\n\n  public view: EditorView\n\n  public preventHide = false\n\n  public tippy: Instance | undefined\n\n  public tippyOptions?: Partial<Props>\n\n  public updateDelay: number\n\n  public shouldShow: Exclude<BubbleMenuPluginProps['shouldShow'], null> = ({\n    view,\n    state,\n    from,\n    to,\n  }) => {\n    const { doc, selection } = state\n    const { empty } = selection\n\n    // Sometime check for `empty` is not enough.\n    // Doubleclick an empty paragraph returns a node size of 2.\n    // So we check also for an empty text size.\n    const isEmptyTextBlock = !doc.textBetween(from, to).length && isTextSelection(state.selection)\n\n    // When clicking on a element inside the bubble menu the editor \"blur\" event\n    // is called and the bubble menu item is focussed. In this case we should\n    // consider the menu as part of the editor and keep showing the menu\n    const isChildOfMenu = this.element.contains(document.activeElement)\n\n    const hasEditorFocus = view.hasFocus() || isChildOfMenu\n\n    if (!hasEditorFocus || empty || isEmptyTextBlock || !this.editor.isEditable) {\n      return false\n    }\n\n    return true\n  }\n\n  constructor({\n    editor,\n    element,\n    view,\n    tippyOptions = {},\n    updateDelay = 250,\n    shouldShow,\n  }: BubbleMenuViewProps) {\n    this.editor = editor\n    this.element = element\n    this.view = view\n    this.updateDelay = updateDelay\n\n    if (shouldShow) {\n      this.shouldShow = shouldShow\n    }\n\n    this.element.addEventListener('mousedown', this.mousedownHandler, { capture: true })\n    this.view.dom.addEventListener('dragstart', this.dragstartHandler)\n    this.editor.on('focus', this.focusHandler)\n    this.editor.on('blur', this.blurHandler)\n    this.tippyOptions = tippyOptions\n    // Detaches menu content from its current parent\n    this.element.remove()\n    this.element.style.visibility = 'visible'\n  }\n\n  mousedownHandler = () => {\n    this.preventHide = true\n  }\n\n  dragstartHandler = () => {\n    this.hide()\n  }\n\n  focusHandler = () => {\n    // we use `setTimeout` to make sure `selection` is already updated\n    setTimeout(() => this.update(this.editor.view))\n  }\n\n  blurHandler = ({ event }: { event: FocusEvent }) => {\n    if (this.preventHide) {\n      this.preventHide = false\n\n      return\n    }\n\n    if (event?.relatedTarget && this.element.parentNode?.contains(event.relatedTarget as Node)) {\n      return\n    }\n\n    this.hide()\n  }\n\n  tippyBlurHandler = (event: FocusEvent) => {\n    this.blurHandler({ event })\n  }\n\n  createTooltip() {\n    const { element: editorElement } = this.editor.options\n    const editorIsAttached = !!editorElement.parentElement\n\n    if (this.tippy || !editorIsAttached) {\n      return\n    }\n\n    this.tippy = tippy(editorElement, {\n      duration: 0,\n      getReferenceClientRect: null,\n      content: this.element,\n      interactive: true,\n      trigger: 'manual',\n      placement: 'top',\n      hideOnClick: 'toggle',\n      ...this.tippyOptions,\n    })\n\n    // maybe we have to hide tippy on its own blur event as well\n    if (this.tippy.popper.firstChild) {\n      (this.tippy.popper.firstChild as HTMLElement).addEventListener('blur', this.tippyBlurHandler)\n    }\n  }\n\n  update(view: EditorView, oldState?: EditorState) {\n    const { state } = view\n    const hasValidSelection = state.selection.$from.pos !== state.selection.$to.pos\n\n    if (this.updateDelay > 0 && hasValidSelection) {\n      debounce(this.updateHandler, this.updateDelay)(view, oldState)\n    } else {\n      this.updateHandler(view, oldState)\n    }\n  }\n\n  updateHandler = (view: EditorView, oldState?: EditorState) => {\n    const { state, composing } = view\n    const { doc, selection } = state\n    const isSame = oldState && oldState.doc.eq(doc) && oldState.selection.eq(selection)\n\n    if (composing || isSame) {\n      return\n    }\n\n    this.createTooltip()\n\n    // support for CellSelections\n    const { ranges } = selection\n    const from = Math.min(...ranges.map(range => range.$from.pos))\n    const to = Math.max(...ranges.map(range => range.$to.pos))\n\n    const shouldShow = this.shouldShow?.({\n      editor: this.editor,\n      view,\n      state,\n      oldState,\n      from,\n      to,\n    })\n\n    if (!shouldShow) {\n      this.hide()\n\n      return\n    }\n\n    this.tippy?.setProps({\n      getReferenceClientRect:\n        this.tippyOptions?.getReferenceClientRect\n        || (() => {\n          if (isNodeSelection(state.selection)) {\n            const node = view.nodeDOM(from) as HTMLElement\n\n            if (node) {\n              return node.getBoundingClientRect()\n            }\n          }\n\n          return posToDOMRect(view, from, to)\n        }),\n    })\n\n    this.show()\n  }\n\n  show() {\n    this.tippy?.show()\n  }\n\n  hide() {\n    this.tippy?.hide()\n  }\n\n  destroy() {\n    if (this.tippy?.popper.firstChild) {\n      (this.tippy.popper.firstChild as HTMLElement).removeEventListener(\n        'blur',\n        this.tippyBlurHandler,\n      )\n    }\n    this.tippy?.destroy()\n    this.element.removeEventListener('mousedown', this.mousedownHandler, { capture: true })\n    this.view.dom.removeEventListener('dragstart', this.dragstartHandler)\n    this.editor.off('focus', this.focusHandler)\n    this.editor.off('blur', this.blurHandler)\n  }\n}\n\nexport const BubbleMenuPlugin = (options: BubbleMenuPluginProps) => {\n  return new Plugin({\n    key:\n      typeof options.pluginKey === 'string' ? new PluginKey(options.pluginKey) : options.pluginKey,\n    view: view => new BubbleMenuView({ view, ...options }),\n  })\n}\n","import { Extension } from '@tiptap/core'\n\nimport { BubbleMenuPlugin, BubbleMenuPluginProps } from './bubble-menu-plugin'\n\nexport type BubbleMenuOptions = Omit<BubbleMenuPluginProps, 'editor' | 'element'> & {\n  element: HTMLElement | null,\n}\n\nexport const BubbleMenu = Extension.create<BubbleMenuOptions>({\n  name: 'bubbleMenu',\n\n  addOptions() {\n    return {\n      element: null,\n      tippyOptions: {},\n      pluginKey: 'bubbleMenu',\n      updateDelay: undefined,\n      shouldShow: null,\n    }\n  },\n\n  addProseMirrorPlugins() {\n    if (!this.options.element) {\n      return []\n    }\n\n    return [\n      BubbleMenuPlugin({\n        pluginKey: this.options.pluginKey,\n        editor: this.editor,\n        element: this.options.element,\n        tippyOptions: this.options.tippyOptions,\n        updateDelay: this.options.updateDelay,\n        shouldShow: this.options.shouldShow,\n      }),\n    ]\n  },\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}