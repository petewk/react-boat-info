{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\petew\\\\OneDrive\\\\Desktop\\\\Web Dev Reboot\\\\react-boat-info\\\\client\\\\src\\\\components\\\\pageindex.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, forwardRef, useImperativeHandle } from 'react';\nimport { Link, NavLink } from 'react-router-dom';\nimport '../App.css';\nimport IndexItem from './listItem.js';\nimport UpdatesSection from './updates.js';\n\n// Tiptap imports\n\nimport { Color } from '@tiptap/extension-color';\nimport Bold from '@tiptap/extension-bold';\nimport Paragraph from '@tiptap/extension-paragraph';\nimport ListItem from '@tiptap/extension-list-item';\nimport TextStyle from '@tiptap/extension-text-style';\nimport { Underline } from '@tiptap/extension-underline';\nimport { EditorContent, useEditor } from '@tiptap/react';\nimport StarterKit from '@tiptap/starter-kit';\nimport { generateHTML } from '@tiptap/react';\nimport { Link as Link1 } from '@tiptap/extension-link';\nimport Image from '@tiptap/extension-image';\nimport Dropcursor from '@tiptap/extension-dropcursor';\nimport Table from '@tiptap/extension-table';\nimport TableCell from '@tiptap/extension-table-cell';\nimport TableHeader from '@tiptap/extension-table-header';\nimport TableRow from '@tiptap/extension-table-row';\nimport { Document, Page, pdfjs } from 'react-pdf';\nimport { Base64 } from 'js-base64';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst pdfjsWorker = await import('pdfjs-dist/build/pdf.worker.entry');\npdfjs.GlobalWorkerOptions.workerSrc = new URL('pdfjs-dist/build/pdf.worker.min.js', import.meta.url).toString();\nconst PageIndex = /*#__PURE__*/_s( /*#__PURE__*/forwardRef(_c = _s((props, ref) => {\n  _s();\n  useImperativeHandle(ref, () => ({\n    setBlankPage() {\n      setFileCurr('');\n    }\n  }));\n  const [backendData, setBackendData] = useState([{}]);\n  const [fileCurr, setFileCurr] = useState(props.fileCurr);\n  const [edit, setEdit] = useState(false);\n\n  // Setting the text page contents\n  const [fileData, setFileData] = useState({});\n  const [bodyHTML, setBodyHTML] = useState(\"\");\n  const [fileTitle, setFileTitle] = useState('');\n\n  //  Search function\n  const [searchResult, setSearchResult] = useState('');\n  const [searchValue, setSearchValue] = useState('');\n\n  // testing directories\n\n  const [directories, setDirectories] = useState([]);\n  const [files, setFiles] = useState([]);\n  const [fileNames, setFileNames] = useState([]);\n  const [thisDir, setThisDir] = useState('');\n\n  // full directories/files object\n  const [fullData, setFullData] = useState({});\n  const [updates, setUpdates] = useState([]);\n\n  // store PDF\n  const [pdfFile, setpdfFile] = useState('');\n  const [numPages, setnumPages] = useState();\n  const [pageNumber, setPageNumber] = useState(1);\n  function onDocumentLoadSuccess(pdf) {\n    setnumPages(pdf._pdfInfo.numPages);\n  }\n  useEffect(() => {\n    fetch(\"/api\").then(response => response.json()).then(data => {\n      setUpdates(data.updateLogs);\n      setFullData(data.directoryInfo);\n      setDirectories(Object.keys(data.directoryInfo).sort());\n      setFileData(data.fileBodies);\n      const holdingArrBodies = [];\n      Object.values(data.fileBodies).map(value => {\n        holdingArrBodies.push(value);\n      });\n      const holdingArrNames = [];\n      Object.keys(data.fileBodies).map(name => {\n        holdingArrNames.push(name);\n      });\n      setFiles(holdingArrBodies);\n      setFileNames(holdingArrNames);\n    });\n  }, []);\n  function findDir(fileName) {\n    var result;\n    let keys = Object.keys(fullData);\n    keys.map(key => {\n      if (fullData[key].includes(fileName)) {\n        result = key;\n      }\n    });\n    return result;\n  }\n  ;\n  function SetPage(e) {\n    let fileAtt;\n    let fileNametemp;\n    if (e.target.classList.contains('fa-file-pdf')) {\n      fileAtt = e.target.parentElement.attributes.filename.value;\n      fileNametemp = e.target.parentElement.innerHTML;\n    } else {\n      fileAtt = e.target.attributes.filename.value;\n      fileNametemp = e.target.innerHTML;\n    }\n    console.log(fileAtt);\n\n    //get current file name and set current file\n    setFileCurr(fileAtt);\n    setPageNumber(1);\n    setFileTitle(fileNametemp.split('<')[0]);\n    var data = {\n      \"folder\": findDir(fileAtt),\n      \"fileName\": fileAtt\n    };\n    setThisDir(findDir(fileAtt));\n    function base64encode(str) {\n      return btoa(unescape(encodeURIComponent(str)));\n    }\n    const requestOptions = {\n      method: 'POST',\n      mode: 'cors',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    };\n    if (fileAtt.includes('.pdf')) {\n      fetch('/getText', requestOptions).then(response => response.body).then(data => {\n        const reader = data.getReader();\n        return new ReadableStream({\n          start(controller) {\n            return pump();\n            function pump() {\n              return reader.read().then(_ref => {\n                let {\n                  done,\n                  value\n                } = _ref;\n                // When no more data needs to be consumed, close the stream\n                if (done) {\n                  controller.close();\n                  return;\n                }\n                // Enqueue the next data chunk into our target stream\n                controller.enqueue(value);\n                return pump();\n              });\n            }\n          }\n        });\n      })\n      // Create a new response out of the stream\n      .then(stream => new Response(stream))\n      // Create an object URL for the response\n      .then(response => response.blob()).then(blob => URL.createObjectURL(blob))\n      // Update image\n      .then(url => setpdfFile(url)).catch(err => console.error(err));\n    } else {\n      fetch('/getText', requestOptions).then(response => response.json()).then(data => {\n        setBodyHTML(generateHTML(data, [Color, TextStyle, Underline, StarterKit, Link1, Image, Dropcursor, TableRow, TableHeader, TableCell, Table]));\n      });\n    }\n  }\n  function changePageNum(e) {\n    let newPage = parseInt(e.target.value);\n    if (newPage <= numPages) {\n      setPageNumber(newPage);\n    } else {\n      setPageNumber(1);\n    }\n  }\n  function pageUp() {\n    if (pageNumber < numPages) {\n      setPageNumber(pageNumber + 1);\n    }\n  }\n  function pageDown() {\n    if (pageNumber > 1) {\n      setPageNumber(pageNumber - 1);\n    }\n  }\n\n  // store this info to local storage for the editor option\n  useEffect(() => {\n    window.localStorage.setItem(\"editorTextBody\", bodyHTML);\n    window.localStorage.setItem(\"editorFileName\", fileTitle.replaceAll(\" \", \"-\"));\n    window.localStorage.setItem(\"category\", thisDir.replaceAll(\" \", \"-\"));\n  });\n\n  // enable editing mode to change contents of existing file\n\n  function enableEdit() {\n    setEdit(!edit);\n  }\n  function searchFilter(e) {\n    const searchVal = e.target.value;\n    setSearchValue(searchVal);\n    let searchReturns = [];\n    let fileNames = [];\n    directories.map(item => {\n      fullData[item].map(item => {\n        fileNames.push(item);\n      });\n    });\n    fileNames.map(item => {\n      if (item.toLowerCase().replaceAll(\"-\", \" \").includes(searchVal.toLowerCase())) {\n        searchReturns.push(item);\n      }\n    });\n    setSearchResult(searchReturns);\n  }\n  function collapseTest(e) {\n    let clickTarget;\n    let arrow;\n    if (e.target.classList.contains('fa-solid')) {\n      clickTarget = e.target.parentElement.nextElementSibling;\n      arrow = e.target;\n    } else {\n      clickTarget = e.target.nextElementSibling;\n      arrow = e.target.lastChild;\n    }\n    ;\n    console.log(\"hello\");\n    clickTarget.classList.toggle('collapsed');\n    arrow.classList.toggle('fa-rotate-180');\n    arrow.classList.toggle('closed');\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"pageIndex\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"searchBox\",\n          placeholder: \"Search...\",\n          onChange: searchFilter\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 17\n      }, this), directories.length === 0 ?\n      /*#__PURE__*/\n      // Render when no files to show\n      _jsxDEV(\"p\", {\n        children: \"Loading\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 29\n      }, this) : searchValue === '' ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: directories.map((item, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              onClick: collapseTest,\n              className: \"directoryHeader\",\n              children: [item[0].toUpperCase() + item.substring(1).replaceAll('-', ' '), /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fa-solid fa-sort-down\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 163\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 45\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"testItems collapsible collapsed\",\n              children: fullData[item].length > 0 ? fullData[item].map((name, i) => name.includes('.pdf') ? /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: SetPage,\n                children: /*#__PURE__*/_jsxDEV(IndexItem, {\n                  filename: name\n                }, name, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 343,\n                  columnNumber: 57\n                }, this)\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 53\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: SetPage,\n                children: /*#__PURE__*/_jsxDEV(IndexItem, {\n                  filename: name\n                }, name, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 351,\n                  columnNumber: 57\n                }, this)\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 350,\n                columnNumber: 53\n              }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"emptyDirectory\",\n                children: \"Nothing here yet!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 358,\n                columnNumber: 53\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 335,\n              columnNumber: 45\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 41\n          }, this))\n        }, void 0, false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 29\n      }, this) :\n      // When search but no results\n      searchResult.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No Results Found...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 37\n      }, this) :\n      // When search and results to show\n\n      searchResult.map((name, i) => name.includes('.pdf') ? /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: SetPage,\n        children: /*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"indexLink searched\",\n          filename: name,\n          children: name.slice(0, -4).replaceAll('-', \" \")\n        }, name, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 45\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 41\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        onClick: SetPage,\n        children: /*#__PURE__*/_jsxDEV(\"h5\", {\n          className: \"indexLink searched\",\n          filename: name,\n          children: name.slice(0, -5).replaceAll('-', \" \")\n        }, name, false, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 49\n        }, this)\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 41\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 13\n    }, this), fileCurr === '' ? /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"textPage\",\n      className: \"flexHomePage\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"defaultScreen\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Welcome to Wikipe-Dea, select a file from the left to view info, or use the button at the top to create a new file and contribute!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: /*#__PURE__*/_jsxDEV(\"ul\", {\n            id: \"guidePoints\",\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"Use the index on the left hand side to search for info you're looking for;\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"If you wish to submit new pages or edit info on an existing page, you will need an authorisation code;\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: \"If you have a suggestion for information you'd like so see a page on which you can't find, or would like to request permission to create/edit new pages, please fill out the Suggestion form through the link in the top right of your screen\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(UpdatesSection, {\n        updates: updates\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 21\n    }, this) : fileCurr.includes('.pdf') ? /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"textPage\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: fileCurr.slice(0, -4)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"pdfPageControls\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"pagesButton\",\n          onClick: pageDown,\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            class: \"fa-solid fa-minus\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 80\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"number\",\n            onChange: changePageNum,\n            value: pageNumber\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 32\n          }, this), \" of \", numPages]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"pagesButton\",\n          onClick: pageUp,\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            class: \"fa-solid fa-plus\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 78\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(Document, {\n        className: \"pdfContainer\",\n        file: pdfFile,\n        onLoadSuccess: onDocumentLoadSuccess,\n        children: /*#__PURE__*/_jsxDEV(Page, {\n          pageNumber: pageNumber\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 429,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 21\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"textPage\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: fileTitle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"textBody\",\n        dangerouslySetInnerHTML: {\n          __html: bodyHTML\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 440,\n        columnNumber: 25\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/edit\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          id: \"editButton\",\n          children: [\"Edit \", /*#__PURE__*/_jsxDEV(\"i\", {\n            class: \"fa-solid fa-pen\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 54\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 441,\n        columnNumber: 25\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 436,\n      columnNumber: 21\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 309,\n    columnNumber: 9\n  }, this);\n}, \"4IfDAcZZpE54EzksbffQZv2ABrg=\")), \"4IfDAcZZpE54EzksbffQZv2ABrg=\");\n_c2 = PageIndex;\nexport default PageIndex;\nvar _c, _c2;\n$RefreshReg$(_c, \"PageIndex$forwardRef\");\n$RefreshReg$(_c2, \"PageIndex\");","map":{"version":3,"names":["React","useEffect","useState","forwardRef","useImperativeHandle","Link","NavLink","IndexItem","UpdatesSection","Color","Bold","Paragraph","ListItem","TextStyle","Underline","EditorContent","useEditor","StarterKit","generateHTML","Link1","Image","Dropcursor","Table","TableCell","TableHeader","TableRow","Document","Page","pdfjs","Base64","jsxDEV","_jsxDEV","Fragment","_Fragment","pdfjsWorker","GlobalWorkerOptions","workerSrc","URL","import","meta","url","toString","PageIndex","_s","_c","props","ref","setBlankPage","setFileCurr","backendData","setBackendData","fileCurr","edit","setEdit","fileData","setFileData","bodyHTML","setBodyHTML","fileTitle","setFileTitle","searchResult","setSearchResult","searchValue","setSearchValue","directories","setDirectories","files","setFiles","fileNames","setFileNames","thisDir","setThisDir","fullData","setFullData","updates","setUpdates","pdfFile","setpdfFile","numPages","setnumPages","pageNumber","setPageNumber","onDocumentLoadSuccess","pdf","_pdfInfo","fetch","then","response","json","data","updateLogs","directoryInfo","Object","keys","sort","fileBodies","holdingArrBodies","values","map","value","push","holdingArrNames","name","findDir","fileName","result","key","includes","SetPage","e","fileAtt","fileNametemp","target","classList","contains","parentElement","attributes","filename","innerHTML","console","log","split","base64encode","str","btoa","unescape","encodeURIComponent","requestOptions","method","mode","headers","body","JSON","stringify","reader","getReader","ReadableStream","start","controller","pump","read","_ref","done","close","enqueue","stream","Response","blob","createObjectURL","catch","err","error","changePageNum","newPage","parseInt","pageUp","pageDown","window","localStorage","setItem","replaceAll","enableEdit","searchFilter","searchVal","searchReturns","item","toLowerCase","collapseTest","clickTarget","arrow","nextElementSibling","lastChild","toggle","id","children","placeholder","onChange","_jsxFileName","lineNumber","columnNumber","length","i","onClick","className","toUpperCase","substring","slice","class","type","file","onLoadSuccess","dangerouslySetInnerHTML","__html","to","_c2","$RefreshReg$"],"sources":["C:/Users/petew/OneDrive/Desktop/Web Dev Reboot/react-boat-info/client/src/components/pageindex.js"],"sourcesContent":["import React, { useEffect, useState, forwardRef,  useImperativeHandle } from 'react';\r\nimport { Link, NavLink } from 'react-router-dom';\r\nimport '../App.css';\r\nimport IndexItem from './listItem.js';\r\nimport UpdatesSection from './updates.js';\r\n\r\n\r\n\r\n// Tiptap imports\r\n\r\nimport { Color } from '@tiptap/extension-color'\r\nimport Bold from '@tiptap/extension-bold';\r\nimport Paragraph from '@tiptap/extension-paragraph';\r\nimport ListItem from '@tiptap/extension-list-item'\r\nimport TextStyle from '@tiptap/extension-text-style'\r\nimport {Underline} from '@tiptap/extension-underline'\r\nimport { EditorContent, useEditor } from '@tiptap/react'\r\nimport StarterKit from '@tiptap/starter-kit'\r\nimport { generateHTML } from '@tiptap/react';\r\nimport {Link as Link1} from '@tiptap/extension-link';\r\nimport Image from '@tiptap/extension-image';\r\nimport Dropcursor from '@tiptap/extension-dropcursor';\r\nimport Table from '@tiptap/extension-table';\r\nimport TableCell from '@tiptap/extension-table-cell';\r\nimport TableHeader from '@tiptap/extension-table-header';\r\nimport TableRow from '@tiptap/extension-table-row';\r\n\r\nimport { Document, Page, pdfjs } from 'react-pdf';\r\nimport { Base64 } from 'js-base64';\r\n\r\n\r\nconst pdfjsWorker = await import('pdfjs-dist/build/pdf.worker.entry');\r\n\r\npdfjs.GlobalWorkerOptions.workerSrc = new URL(\r\n    'pdfjs-dist/build/pdf.worker.min.js',\r\n    import.meta.url,\r\n  ).toString();\r\n\r\n\r\n\r\nconst PageIndex = forwardRef((props, ref)=>{\r\n    useImperativeHandle(ref, ()=>({\r\n        setBlankPage(){\r\n            setFileCurr('')\r\n        },\r\n    }))\r\n\r\n\r\n    const [backendData, setBackendData] = useState([{}]);\r\n\r\n    const [fileCurr, setFileCurr] = useState(props.fileCurr);\r\n    const [edit, setEdit] = useState(false);\r\n\r\n    // Setting the text page contents\r\n    const [fileData, setFileData] = useState({});\r\n    const [bodyHTML, setBodyHTML] = useState(\"\");\r\n    const [fileTitle, setFileTitle] = useState('');\r\n\r\n\r\n    //  Search function\r\n    const [searchResult, setSearchResult] = useState('');\r\n    const [searchValue, setSearchValue] = useState('');\r\n\r\n\r\n\r\n    // testing directories\r\n\r\n    const [directories, setDirectories] = useState([]);\r\n    const [files, setFiles] = useState([]);\r\n    const [fileNames, setFileNames] = useState([]);\r\n    const [thisDir, setThisDir] = useState('');\r\n\r\n    // full directories/files object\r\n    const [fullData, setFullData] = useState({});\r\n    const [updates, setUpdates] = useState([]);\r\n\r\n\r\n    // store PDF\r\n    const [pdfFile, setpdfFile] = useState('');\r\n    const [numPages, setnumPages] = useState();\r\n    const [pageNumber, setPageNumber] = useState(1);\r\n\r\n    function onDocumentLoadSuccess(pdf){\r\n        setnumPages(pdf._pdfInfo.numPages);\r\n      }\r\n\r\n\r\n\r\n\r\n    useEffect(()=>{\r\n        fetch(\"/api\")\r\n        .then(\r\n            response => response.json()\r\n        ).then(\r\n            data => {\r\n                setUpdates(data.updateLogs);\r\n                setFullData(data.directoryInfo);\r\n                setDirectories(Object.keys(data.directoryInfo).sort());\r\n                setFileData(data.fileBodies)\r\n                \r\n                const holdingArrBodies = []\r\n                Object.values(data.fileBodies).map((value)=>{\r\n                        holdingArrBodies.push(value)\r\n                });\r\n\r\n                const holdingArrNames = [];\r\n                Object.keys(data.fileBodies).map((name)=>{\r\n                    holdingArrNames.push(name);\r\n                })\r\n                setFiles(holdingArrBodies);\r\n                setFileNames(holdingArrNames);\r\n            }\r\n        );\r\n    }, []);\r\n\r\n\r\n    function findDir(fileName){\r\n        var result;\r\n        let keys = Object.keys(fullData);\r\n        keys.map((key)=>{\r\n            if(fullData[key].includes(fileName)){\r\n                result = key\r\n            }\r\n        })\r\n        return result;\r\n    };\r\n\r\n    \r\n\r\n\r\n    function SetPage(e){\r\n\r\n        let fileAtt;\r\n        let fileNametemp;\r\n        \r\n        if(e.target.classList.contains('fa-file-pdf')){\r\n            fileAtt = e.target.parentElement.attributes.filename.value;\r\n            fileNametemp = e.target.parentElement.innerHTML;\r\n        } else {\r\n            fileAtt = e.target.attributes.filename.value;\r\n            fileNametemp = e.target.innerHTML;\r\n        }\r\n\r\n        console.log(fileAtt);\r\n        \r\n        //get current file name and set current file\r\n        setFileCurr(fileAtt);\r\n        setPageNumber(1);\r\n\r\n        setFileTitle(fileNametemp.split('<')[0]);\r\n\r\n    \r\n        var data = {\r\n            \"folder\": findDir(fileAtt),\r\n            \"fileName\": fileAtt\r\n        };\r\n        setThisDir(findDir(fileAtt));\r\n\r\n\r\n        function base64encode(str) {\r\n            return btoa(unescape(encodeURIComponent(str)))\r\n          }\r\n       \r\n\r\n        const requestOptions = {\r\n            method: 'POST',\r\n            mode: 'cors',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify(data)\r\n        };\r\n\r\n        if (fileAtt.includes('.pdf')){\r\n            fetch('/getText', requestOptions).then(\r\n                response=>response.body\r\n            ).then(              \r\n                data=>{\r\n                    const reader = data.getReader();\r\n                    return new ReadableStream({\r\n                      start(controller) {\r\n                        return pump();\r\n                        function pump() {\r\n                          return reader.read().then(({ done, value }) => {\r\n                            // When no more data needs to be consumed, close the stream\r\n                            if (done) {\r\n                              controller.close();\r\n                              return;\r\n                            }\r\n                            // Enqueue the next data chunk into our target stream\r\n                            controller.enqueue(value);\r\n                            return pump();\r\n                          });\r\n                        }\r\n                      },\r\n                    });\r\n                  })\r\n                  // Create a new response out of the stream\r\n                  .then((stream) => new Response(stream))\r\n                  // Create an object URL for the response\r\n                  .then((response) => response.blob())\r\n                  .then((blob) => URL.createObjectURL(blob))\r\n                  // Update image\r\n                  .then((url) => setpdfFile(url))\r\n                  .catch((err) => console.error(err));\r\n        } else {\r\n            fetch('/getText', requestOptions).then(\r\n                response=>response.json()\r\n            ).then(\r\n                data=>{\r\n                    setBodyHTML(generateHTML(data, [\r\n                        Color,\r\n                        TextStyle,\r\n                        Underline,\r\n                        StarterKit,\r\n                        Link1,\r\n                        Image,\r\n                        Dropcursor,\r\n                        TableRow,\r\n                        TableHeader,\r\n                        TableCell,\r\n                        Table,\r\n                    ]));\r\n                }\r\n            );\r\n        }\r\n\r\n\r\n    }\r\n\r\n    function changePageNum(e){\r\n        let newPage = parseInt(e.target.value);\r\n        if(newPage <= numPages){\r\n            setPageNumber(newPage);\r\n        } else {\r\n            setPageNumber(1)\r\n        }\r\n    }\r\n\r\n\r\n    function pageUp(){\r\n        if(pageNumber < numPages){\r\n            setPageNumber(pageNumber + 1)\r\n        }\r\n\r\n    }\r\n\r\n    function pageDown(){\r\n        if(pageNumber > 1){\r\n            setPageNumber(pageNumber - 1)\r\n        }\r\n    }\r\n    \r\n\r\n    // store this info to local storage for the editor option\r\n    useEffect(()=>{\r\n        \r\n        window.localStorage.setItem(\"editorTextBody\", bodyHTML);\r\n        window.localStorage.setItem(\"editorFileName\", fileTitle.replaceAll(\" \", \"-\"));\r\n        window.localStorage.setItem(\"category\", thisDir.replaceAll(\" \", \"-\"));\r\n    })\r\n\r\n    \r\n\r\n    // enable editing mode to change contents of existing file\r\n\r\n    function enableEdit(){\r\n        setEdit(!edit);\r\n    }\r\n\r\n    function searchFilter(e){\r\n        const searchVal = e.target.value;\r\n        setSearchValue(searchVal);\r\n        let searchReturns = [];\r\n        let fileNames = [];\r\n        directories.map((item)=>{\r\n            fullData[item].map((item)=>{\r\n                fileNames.push(item)\r\n            })\r\n        });\r\n        fileNames.map((item)=>{\r\n            if(item.toLowerCase().replaceAll(\"-\", \" \").includes(searchVal.toLowerCase())){\r\n                searchReturns.push(item)\r\n            }\r\n        })\r\n        setSearchResult(searchReturns)\r\n    }\r\n\r\n    function collapseTest(e){\r\n        let clickTarget;\r\n        let arrow;\r\n        if(e.target.classList.contains('fa-solid')){\r\n            clickTarget = e.target.parentElement.nextElementSibling;\r\n            arrow = e.target;\r\n        } else {\r\n            clickTarget = e.target.nextElementSibling;\r\n            arrow = e.target.lastChild;\r\n        };\r\n        console.log(\"hello\")\r\n        clickTarget.classList.toggle('collapsed');\r\n        \r\n        arrow.classList.toggle('fa-rotate-180');\r\n        arrow.classList.toggle('closed');\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    return (\r\n        <div id=\"container\">\r\n\r\n            {/* Page index list here */}\r\n\r\n            <div id=\"pageIndex\">\r\n                <div>\r\n                    <input id=\"searchBox\" placeholder=\"Search...\" onChange={searchFilter}></input>\r\n                </div>\r\n                        {(directories.length === 0) ? (\r\n                            // Render when no files to show\r\n\r\n                            <p>Loading</p> \r\n\r\n                        ): (\r\n\r\n                            (searchValue === '') ? (\r\n\r\n                            <div>\r\n                                {/* Render when files but no search */}\r\n\r\n                                <>\r\n                                \r\n                                    {directories.map((item, i)=>(\r\n                                        <div key={i}>\r\n                                            <p onClick={collapseTest} className='directoryHeader'>{item[0].toUpperCase() + item.substring(1).replaceAll('-', ' ')}<i className=\"fa-solid fa-sort-down\"></i></p>\r\n\r\n                                            <div className=\"testItems collapsible collapsed\">\r\n                                                {\r\n                                                    fullData[item].length > 0 ? \r\n                                                \r\n                                                fullData[item].map((name, i)=>(\r\n\r\n                                                    name.includes('.pdf') ? (\r\n                                                    <div key={i} onClick={SetPage}>\r\n                                                        <IndexItem filename={name} key={name}/>\r\n                                                    </div>\r\n                                                    )\r\n\r\n                                                    :\r\n\r\n                                                    (\r\n                                                    <div key={i} onClick={SetPage}>\r\n                                                        <IndexItem filename={name} key={name}/>\r\n                                                    </div>\r\n                                                    )\r\n                                                ))\r\n                                            \r\n                                                    :\r\n\r\n                                                    <p className=\"emptyDirectory\">Nothing here yet!</p>\r\n                                            \r\n                                            }\r\n                                            </div>\r\n                                        </div>\r\n                                    ))}\r\n                                </>\r\n\r\n                            </div>\r\n\r\n                            ) : (\r\n\r\n                                // When search but no results\r\n                                (searchResult.length === 0) ? (\r\n\r\n                                    <p>No Results Found...</p>\r\n                                ) \r\n\r\n                                : \r\n\r\n                                // When search and results to show\r\n\r\n                                (\r\n                                    (searchResult.map((name, i)=>(\r\n                                        name.includes('.pdf') ? (\r\n                                        <div key={i} onClick={SetPage} >\r\n                                            <h5 className=\"indexLink searched\" filename={name} key={name} >{name.slice(0, -4).replaceAll('-', \" \")}</h5>\r\n                                        </div>\r\n                                        )\r\n                                         :\r\n                                        (\r\n                                        <div key={i} onClick={SetPage} >\r\n                                                <h5 className=\"indexLink searched\" filename={name} key={name} >{name.slice(0, -5).replaceAll('-', \" \")}</h5>\r\n                                        </div>\r\n                                        )\r\n                                    ))\r\n                                )\r\n                                )\r\n                            )\r\n\r\n                    \r\n                        )}\r\n            </div>  \r\n\r\n\r\n            {/* Text and body going here */}                              \r\n\r\n                {fileCurr === '' ? (\r\n                    <div id=\"textPage\" className='flexHomePage'>\r\n                    <div id=\"defaultScreen\">\r\n                        <h2>Welcome to Wikipe-Dea, select a file from the left to view info, or use the button at the top to create a new file and contribute!</h2>\r\n                        <div>\r\n                            <ul id=\"guidePoints\">\r\n                                <li>Use the index on the left hand side to search for info you're looking for;</li>\r\n                                <li>If you wish to submit new pages or edit info on an existing page, you will need an authorisation code;</li>\r\n                                <li>If you have a suggestion for information you'd like so see a page on which you can't find, or would like to request permission to create/edit new pages, please fill out the Suggestion form through the link in the top right of your screen</li>\r\n                            </ul>\r\n                        </div>\r\n                    </div>\r\n                    <UpdatesSection updates={updates}/>\r\n                    </div>\r\n\r\n                ) : (\r\n                    (fileCurr.includes('.pdf')) ? (\r\n                    <div id=\"textPage\">\r\n                        <h1>{fileCurr.slice(0, -4)}</h1>\r\n                        <div className='pdfPageControls'>\r\n                            <button className=\"pagesButton\" onClick={pageDown}><i class=\"fa-solid fa-minus\"></i></button>\r\n                            <b><input type='number' onChange={changePageNum} value={pageNumber}></input> of {numPages}</b>\r\n                            <button className=\"pagesButton\" onClick={pageUp}><i class=\"fa-solid fa-plus\"></i></button>\r\n                        </div>\r\n                        <Document className='pdfContainer' file={pdfFile} onLoadSuccess={onDocumentLoadSuccess}>\r\n                            <Page pageNumber={pageNumber}/>\r\n                        </Document>\r\n                    </div>\r\n                    )\r\n                    :\r\n                    (\r\n                    <div id=\"textPage\">\r\n                        <h1>\r\n                            {fileTitle}\r\n                        </h1>\r\n                        <div className='textBody' dangerouslySetInnerHTML={{__html: bodyHTML}}>{}</div>\r\n                        <Link to=\"/edit\">\r\n                        <button id=\"editButton\">Edit <i class=\"fa-solid fa-pen\"></i></button>\r\n                        </Link>\r\n                        \r\n                    </div>\r\n                    )\r\n\r\n                    \r\n                    )\r\n                }\r\n        </div>\r\n\r\n    )\r\n}\r\n)\r\n\r\nexport default PageIndex"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}