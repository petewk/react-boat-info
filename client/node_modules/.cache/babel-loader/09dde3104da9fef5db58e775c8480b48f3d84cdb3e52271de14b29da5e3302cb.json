{"ast":null,"code":"import { isTextSelection, isNodeSelection, posToDOMRect, Extension } from '@tiptap/core';\nimport { Plugin, PluginKey } from '@tiptap/pm/state';\nimport tippy from 'tippy.js';\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\n\nfunction isObject$2(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\nvar isObject_1 = isObject$2;\n\n/** Detect free variable `global` from Node.js. */\n\nvar freeGlobal$1 = typeof commonjsGlobal == 'object' && commonjsGlobal && commonjsGlobal.Object === Object && commonjsGlobal;\nvar _freeGlobal = freeGlobal$1;\nvar freeGlobal = _freeGlobal;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root$2 = freeGlobal || freeSelf || Function('return this')();\nvar _root = root$2;\nvar root$1 = _root;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now$1 = function () {\n  return root$1.Date.now();\n};\nvar now_1 = now$1;\n\n/** Used to match a single whitespace character. */\n\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex$1(string) {\n  var index = string.length;\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\nvar _trimmedEndIndex = trimmedEndIndex$1;\nvar trimmedEndIndex = _trimmedEndIndex;\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim$1(string) {\n  return string ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '') : string;\n}\nvar _baseTrim = baseTrim$1;\nvar root = _root;\n\n/** Built-in value references. */\nvar Symbol$2 = root.Symbol;\nvar _Symbol = Symbol$2;\nvar Symbol$1 = _Symbol;\n\n/** Used for built-in method references. */\nvar objectProto$1 = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto$1.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString$1 = objectProto$1.toString;\n\n/** Built-in value references. */\nvar symToStringTag$1 = Symbol$1 ? Symbol$1.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag$1(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag$1),\n    tag = value[symToStringTag$1];\n  try {\n    value[symToStringTag$1] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n  var result = nativeObjectToString$1.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag$1] = tag;\n    } else {\n      delete value[symToStringTag$1];\n    }\n  }\n  return result;\n}\nvar _getRawTag = getRawTag$1;\n\n/** Used for built-in method references. */\n\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString$1(value) {\n  return nativeObjectToString.call(value);\n}\nvar _objectToString = objectToString$1;\nvar Symbol = _Symbol,\n  getRawTag = _getRawTag,\n  objectToString = _objectToString;\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n  undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag$1(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return symToStringTag && symToStringTag in Object(value) ? getRawTag(value) : objectToString(value);\n}\nvar _baseGetTag = baseGetTag$1;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\n\nfunction isObjectLike$1(value) {\n  return value != null && typeof value == 'object';\n}\nvar isObjectLike_1 = isObjectLike$1;\nvar baseGetTag = _baseGetTag,\n  isObjectLike = isObjectLike_1;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol$1(value) {\n  return typeof value == 'symbol' || isObjectLike(value) && baseGetTag(value) == symbolTag;\n}\nvar isSymbol_1 = isSymbol$1;\nvar baseTrim = _baseTrim,\n  isObject$1 = isObject_1,\n  isSymbol = isSymbol_1;\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber$1(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject$1(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject$1(other) ? other + '' : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return isBinary || reIsOctal.test(value) ? freeParseInt(value.slice(2), isBinary ? 2 : 8) : reIsBadHex.test(value) ? NAN : +value;\n}\nvar toNumber_1 = toNumber$1;\nvar isObject = isObject_1,\n  now = now_1,\n  toNumber = toNumber_1;\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n  nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n    lastThis,\n    maxWait,\n    result,\n    timerId,\n    lastCallTime,\n    lastInvokeTime = 0,\n    leading = false,\n    maxing = false,\n    trailing = true;\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  function invokeFunc(time) {\n    var args = lastArgs,\n      thisArg = lastThis;\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n      timeSinceLastInvoke = time - lastInvokeTime,\n      timeWaiting = wait - timeSinceLastCall;\n    return maxing ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke) : timeWaiting;\n  }\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n      timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return lastCallTime === undefined || timeSinceLastCall >= wait || timeSinceLastCall < 0 || maxing && timeSinceLastInvoke >= maxWait;\n  }\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n  function debounced() {\n    var time = now(),\n      isInvoking = shouldInvoke(time);\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\nvar debounce_1 = debounce;\nclass BubbleMenuView {\n  constructor(_ref) {\n    let {\n      editor,\n      element,\n      view,\n      tippyOptions = {},\n      updateDelay = 250,\n      shouldShow\n    } = _ref;\n    this.preventHide = false;\n    this.shouldShow = _ref2 => {\n      let {\n        view,\n        state,\n        from,\n        to\n      } = _ref2;\n      const {\n        doc,\n        selection\n      } = state;\n      const {\n        empty\n      } = selection;\n      // Sometime check for `empty` is not enough.\n      // Doubleclick an empty paragraph returns a node size of 2.\n      // So we check also for an empty text size.\n      const isEmptyTextBlock = !doc.textBetween(from, to).length && isTextSelection(state.selection);\n      // When clicking on a element inside the bubble menu the editor \"blur\" event\n      // is called and the bubble menu item is focussed. In this case we should\n      // consider the menu as part of the editor and keep showing the menu\n      const isChildOfMenu = this.element.contains(document.activeElement);\n      const hasEditorFocus = view.hasFocus() || isChildOfMenu;\n      if (!hasEditorFocus || empty || isEmptyTextBlock || !this.editor.isEditable) {\n        return false;\n      }\n      return true;\n    };\n    this.mousedownHandler = () => {\n      this.preventHide = true;\n    };\n    this.dragstartHandler = () => {\n      this.hide();\n    };\n    this.focusHandler = () => {\n      // we use `setTimeout` to make sure `selection` is already updated\n      setTimeout(() => this.update(this.editor.view));\n    };\n    this.blurHandler = _ref3 => {\n      let {\n        event\n      } = _ref3;\n      var _a;\n      if (this.preventHide) {\n        this.preventHide = false;\n        return;\n      }\n      if ((event === null || event === void 0 ? void 0 : event.relatedTarget) && ((_a = this.element.parentNode) === null || _a === void 0 ? void 0 : _a.contains(event.relatedTarget))) {\n        return;\n      }\n      this.hide();\n    };\n    this.tippyBlurHandler = event => {\n      this.blurHandler({\n        event\n      });\n    };\n    this.updateHandler = (view, oldState) => {\n      var _a, _b, _c;\n      const {\n        state,\n        composing\n      } = view;\n      const {\n        doc,\n        selection\n      } = state;\n      const isSame = oldState && oldState.doc.eq(doc) && oldState.selection.eq(selection);\n      if (composing || isSame) {\n        return;\n      }\n      this.createTooltip();\n      // support for CellSelections\n      const {\n        ranges\n      } = selection;\n      const from = Math.min(...ranges.map(range => range.$from.pos));\n      const to = Math.max(...ranges.map(range => range.$to.pos));\n      const shouldShow = (_a = this.shouldShow) === null || _a === void 0 ? void 0 : _a.call(this, {\n        editor: this.editor,\n        view,\n        state,\n        oldState,\n        from,\n        to\n      });\n      if (!shouldShow) {\n        this.hide();\n        return;\n      }\n      (_b = this.tippy) === null || _b === void 0 ? void 0 : _b.setProps({\n        getReferenceClientRect: ((_c = this.tippyOptions) === null || _c === void 0 ? void 0 : _c.getReferenceClientRect) || (() => {\n          if (isNodeSelection(state.selection)) {\n            const node = view.nodeDOM(from);\n            if (node) {\n              return node.getBoundingClientRect();\n            }\n          }\n          return posToDOMRect(view, from, to);\n        })\n      });\n      this.show();\n    };\n    this.editor = editor;\n    this.element = element;\n    this.view = view;\n    this.updateDelay = updateDelay;\n    if (shouldShow) {\n      this.shouldShow = shouldShow;\n    }\n    this.element.addEventListener('mousedown', this.mousedownHandler, {\n      capture: true\n    });\n    this.view.dom.addEventListener('dragstart', this.dragstartHandler);\n    this.editor.on('focus', this.focusHandler);\n    this.editor.on('blur', this.blurHandler);\n    this.tippyOptions = tippyOptions;\n    // Detaches menu content from its current parent\n    this.element.remove();\n    this.element.style.visibility = 'visible';\n  }\n  createTooltip() {\n    const {\n      element: editorElement\n    } = this.editor.options;\n    const editorIsAttached = !!editorElement.parentElement;\n    if (this.tippy || !editorIsAttached) {\n      return;\n    }\n    this.tippy = tippy(editorElement, {\n      duration: 0,\n      getReferenceClientRect: null,\n      content: this.element,\n      interactive: true,\n      trigger: 'manual',\n      placement: 'top',\n      hideOnClick: 'toggle',\n      ...this.tippyOptions\n    });\n    // maybe we have to hide tippy on its own blur event as well\n    if (this.tippy.popper.firstChild) {\n      this.tippy.popper.firstChild.addEventListener('blur', this.tippyBlurHandler);\n    }\n  }\n  update(view, oldState) {\n    const {\n      state\n    } = view;\n    const hasValidSelection = state.selection.$from.pos !== state.selection.$to.pos;\n    if (this.updateDelay > 0 && hasValidSelection) {\n      debounce_1(this.updateHandler, this.updateDelay)(view, oldState);\n    } else {\n      this.updateHandler(view, oldState);\n    }\n  }\n  show() {\n    var _a;\n    (_a = this.tippy) === null || _a === void 0 ? void 0 : _a.show();\n  }\n  hide() {\n    var _a;\n    (_a = this.tippy) === null || _a === void 0 ? void 0 : _a.hide();\n  }\n  destroy() {\n    var _a, _b;\n    if ((_a = this.tippy) === null || _a === void 0 ? void 0 : _a.popper.firstChild) {\n      this.tippy.popper.firstChild.removeEventListener('blur', this.tippyBlurHandler);\n    }\n    (_b = this.tippy) === null || _b === void 0 ? void 0 : _b.destroy();\n    this.element.removeEventListener('mousedown', this.mousedownHandler, {\n      capture: true\n    });\n    this.view.dom.removeEventListener('dragstart', this.dragstartHandler);\n    this.editor.off('focus', this.focusHandler);\n    this.editor.off('blur', this.blurHandler);\n  }\n}\nconst BubbleMenuPlugin = options => {\n  return new Plugin({\n    key: typeof options.pluginKey === 'string' ? new PluginKey(options.pluginKey) : options.pluginKey,\n    view: view => new BubbleMenuView({\n      view,\n      ...options\n    })\n  });\n};\nconst BubbleMenu = Extension.create({\n  name: 'bubbleMenu',\n  addOptions() {\n    return {\n      element: null,\n      tippyOptions: {},\n      pluginKey: 'bubbleMenu',\n      updateDelay: undefined,\n      shouldShow: null\n    };\n  },\n  addProseMirrorPlugins() {\n    if (!this.options.element) {\n      return [];\n    }\n    return [BubbleMenuPlugin({\n      pluginKey: this.options.pluginKey,\n      editor: this.editor,\n      element: this.options.element,\n      tippyOptions: this.options.tippyOptions,\n      updateDelay: this.options.updateDelay,\n      shouldShow: this.options.shouldShow\n    })];\n  }\n});\nexport { BubbleMenu, BubbleMenuPlugin, BubbleMenuView, BubbleMenu as default };","map":{"version":3,"mappings":"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","names":["isObject","value","type","freeGlobal","global","Object","require$$0","freeSelf","self","root","Function","now","Date","reWhitespace","trimmedEndIndex","string","index","length","test","charAt","reTrimStart","baseTrim","slice","replace","Symbol","objectProto","prototype","hasOwnProperty","nativeObjectToString","toString","symToStringTag","toStringTag","undefined","getRawTag","isOwn","call","tag","unmasked","e","result","objectToString","require$$1","require$$2","nullTag","undefinedTag","baseGetTag","isObjectLike","symbolTag","isSymbol","NAN","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","toNumber","other","valueOf","isBinary","FUNC_ERROR_TEXT","nativeMax","Math","max","nativeMin","min","debounce","func","wait","options","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","apply","leadingEdge","setTimeout","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","cancel","clearTimeout","flush","debounced","isInvoking","arguments","BubbleMenuView","constructor","editor","element","view","tippyOptions","updateDelay","shouldShow","state","from","to","doc","selection","empty","isEmptyTextBlock","textBetween","isTextSelection","isChildOfMenu","contains","document","activeElement","hasEditorFocus","hasFocus","isEditable","preventHide","hide","update","event","relatedTarget","parentNode","blurHandler","oldState","composing","isSame","eq","createTooltip","ranges","map","range","$from","pos","$to","tippy","setProps","getReferenceClientRect","isNodeSelection","node","nodeDOM","getBoundingClientRect","posToDOMRect","show","addEventListener","mousedownHandler","capture","dom","dragstartHandler","on","focusHandler","remove","style","visibility","editorElement","editorIsAttached","parentElement","duration","content","interactive","trigger","placement","hideOnClick","popper","firstChild","tippyBlurHandler","hasValidSelection","updateHandler","destroy","removeEventListener","off","Plugin","key","pluginKey","PluginKey","Extension","create","name","addOptions","addProseMirrorPlugins","BubbleMenuPlugin"],"sources":["C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\isObject.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_freeGlobal.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_root.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\now.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_trimmedEndIndex.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_baseTrim.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_Symbol.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_getRawTag.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_objectToString.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\_baseGetTag.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\isObjectLike.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\isSymbol.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\toNumber.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\node_modules\\lodash\\debounce.js","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\@tiptap\\extension-bubble-menu\\src\\bubble-menu-plugin.ts","C:\\Users\\petew\\OneDrive\\Desktop\\Web Dev Reboot\\react-boat-info\\client\\node_modules\\@tiptap\\extension-bubble-menu\\src\\bubble-menu.ts"],"sourcesContent":["/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","import {\n  Editor, isNodeSelection, isTextSelection, posToDOMRect,\n} from '@tiptap/core'\nimport { EditorState, Plugin, PluginKey } from '@tiptap/pm/state'\nimport { EditorView } from '@tiptap/pm/view'\nimport debounce from 'lodash/debounce'\nimport tippy, { Instance, Props } from 'tippy.js'\n\nexport interface BubbleMenuPluginProps {\n  pluginKey: PluginKey | string\n  editor: Editor\n  element: HTMLElement\n  tippyOptions?: Partial<Props>\n  updateDelay?: number\n  shouldShow?:\n    | ((props: {\n        editor: Editor\n        view: EditorView\n        state: EditorState\n        oldState?: EditorState\n        from: number\n        to: number\n      }) => boolean)\n    | null\n}\n\nexport type BubbleMenuViewProps = BubbleMenuPluginProps & {\n  view: EditorView\n}\n\nexport class BubbleMenuView {\n  public editor: Editor\n\n  public element: HTMLElement\n\n  public view: EditorView\n\n  public preventHide = false\n\n  public tippy: Instance | undefined\n\n  public tippyOptions?: Partial<Props>\n\n  public updateDelay: number\n\n  public shouldShow: Exclude<BubbleMenuPluginProps['shouldShow'], null> = ({\n    view,\n    state,\n    from,\n    to,\n  }) => {\n    const { doc, selection } = state\n    const { empty } = selection\n\n    // Sometime check for `empty` is not enough.\n    // Doubleclick an empty paragraph returns a node size of 2.\n    // So we check also for an empty text size.\n    const isEmptyTextBlock = !doc.textBetween(from, to).length && isTextSelection(state.selection)\n\n    // When clicking on a element inside the bubble menu the editor \"blur\" event\n    // is called and the bubble menu item is focussed. In this case we should\n    // consider the menu as part of the editor and keep showing the menu\n    const isChildOfMenu = this.element.contains(document.activeElement)\n\n    const hasEditorFocus = view.hasFocus() || isChildOfMenu\n\n    if (!hasEditorFocus || empty || isEmptyTextBlock || !this.editor.isEditable) {\n      return false\n    }\n\n    return true\n  }\n\n  constructor({\n    editor,\n    element,\n    view,\n    tippyOptions = {},\n    updateDelay = 250,\n    shouldShow,\n  }: BubbleMenuViewProps) {\n    this.editor = editor\n    this.element = element\n    this.view = view\n    this.updateDelay = updateDelay\n\n    if (shouldShow) {\n      this.shouldShow = shouldShow\n    }\n\n    this.element.addEventListener('mousedown', this.mousedownHandler, { capture: true })\n    this.view.dom.addEventListener('dragstart', this.dragstartHandler)\n    this.editor.on('focus', this.focusHandler)\n    this.editor.on('blur', this.blurHandler)\n    this.tippyOptions = tippyOptions\n    // Detaches menu content from its current parent\n    this.element.remove()\n    this.element.style.visibility = 'visible'\n  }\n\n  mousedownHandler = () => {\n    this.preventHide = true\n  }\n\n  dragstartHandler = () => {\n    this.hide()\n  }\n\n  focusHandler = () => {\n    // we use `setTimeout` to make sure `selection` is already updated\n    setTimeout(() => this.update(this.editor.view))\n  }\n\n  blurHandler = ({ event }: { event: FocusEvent }) => {\n    if (this.preventHide) {\n      this.preventHide = false\n\n      return\n    }\n\n    if (event?.relatedTarget && this.element.parentNode?.contains(event.relatedTarget as Node)) {\n      return\n    }\n\n    this.hide()\n  }\n\n  tippyBlurHandler = (event: FocusEvent) => {\n    this.blurHandler({ event })\n  }\n\n  createTooltip() {\n    const { element: editorElement } = this.editor.options\n    const editorIsAttached = !!editorElement.parentElement\n\n    if (this.tippy || !editorIsAttached) {\n      return\n    }\n\n    this.tippy = tippy(editorElement, {\n      duration: 0,\n      getReferenceClientRect: null,\n      content: this.element,\n      interactive: true,\n      trigger: 'manual',\n      placement: 'top',\n      hideOnClick: 'toggle',\n      ...this.tippyOptions,\n    })\n\n    // maybe we have to hide tippy on its own blur event as well\n    if (this.tippy.popper.firstChild) {\n      (this.tippy.popper.firstChild as HTMLElement).addEventListener('blur', this.tippyBlurHandler)\n    }\n  }\n\n  update(view: EditorView, oldState?: EditorState) {\n    const { state } = view\n    const hasValidSelection = state.selection.$from.pos !== state.selection.$to.pos\n\n    if (this.updateDelay > 0 && hasValidSelection) {\n      debounce(this.updateHandler, this.updateDelay)(view, oldState)\n    } else {\n      this.updateHandler(view, oldState)\n    }\n  }\n\n  updateHandler = (view: EditorView, oldState?: EditorState) => {\n    const { state, composing } = view\n    const { doc, selection } = state\n    const isSame = oldState && oldState.doc.eq(doc) && oldState.selection.eq(selection)\n\n    if (composing || isSame) {\n      return\n    }\n\n    this.createTooltip()\n\n    // support for CellSelections\n    const { ranges } = selection\n    const from = Math.min(...ranges.map(range => range.$from.pos))\n    const to = Math.max(...ranges.map(range => range.$to.pos))\n\n    const shouldShow = this.shouldShow?.({\n      editor: this.editor,\n      view,\n      state,\n      oldState,\n      from,\n      to,\n    })\n\n    if (!shouldShow) {\n      this.hide()\n\n      return\n    }\n\n    this.tippy?.setProps({\n      getReferenceClientRect:\n        this.tippyOptions?.getReferenceClientRect\n        || (() => {\n          if (isNodeSelection(state.selection)) {\n            const node = view.nodeDOM(from) as HTMLElement\n\n            if (node) {\n              return node.getBoundingClientRect()\n            }\n          }\n\n          return posToDOMRect(view, from, to)\n        }),\n    })\n\n    this.show()\n  }\n\n  show() {\n    this.tippy?.show()\n  }\n\n  hide() {\n    this.tippy?.hide()\n  }\n\n  destroy() {\n    if (this.tippy?.popper.firstChild) {\n      (this.tippy.popper.firstChild as HTMLElement).removeEventListener(\n        'blur',\n        this.tippyBlurHandler,\n      )\n    }\n    this.tippy?.destroy()\n    this.element.removeEventListener('mousedown', this.mousedownHandler, { capture: true })\n    this.view.dom.removeEventListener('dragstart', this.dragstartHandler)\n    this.editor.off('focus', this.focusHandler)\n    this.editor.off('blur', this.blurHandler)\n  }\n}\n\nexport const BubbleMenuPlugin = (options: BubbleMenuPluginProps) => {\n  return new Plugin({\n    key:\n      typeof options.pluginKey === 'string' ? new PluginKey(options.pluginKey) : options.pluginKey,\n    view: view => new BubbleMenuView({ view, ...options }),\n  })\n}\n","import { Extension } from '@tiptap/core'\n\nimport { BubbleMenuPlugin, BubbleMenuPluginProps } from './bubble-menu-plugin'\n\nexport type BubbleMenuOptions = Omit<BubbleMenuPluginProps, 'editor' | 'element'> & {\n  element: HTMLElement | null,\n}\n\nexport const BubbleMenu = Extension.create<BubbleMenuOptions>({\n  name: 'bubbleMenu',\n\n  addOptions() {\n    return {\n      element: null,\n      tippyOptions: {},\n      pluginKey: 'bubbleMenu',\n      updateDelay: undefined,\n      shouldShow: null,\n    }\n  },\n\n  addProseMirrorPlugins() {\n    if (!this.options.element) {\n      return []\n    }\n\n    return [\n      BubbleMenuPlugin({\n        pluginKey: this.options.pluginKey,\n        editor: this.editor,\n        element: this.options.element,\n        tippyOptions: this.options.tippyOptions,\n        updateDelay: this.options.updateDelay,\n        shouldShow: this.options.shouldShow,\n      }),\n    ]\n  },\n})\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}